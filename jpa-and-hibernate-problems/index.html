
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JPA and Hibernate Problems</title>

  <link rel="shortcut icon" href="../assets/favicon.ico">

  <style>
/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}*,:after,:before{box-sizing:border-box}.wrapper{padding:25px 0}@media only screen and (min-width:64.063em){.wrapper{padding:32px 0}}.off-canvas-container{display:-webkit-box;display:-ms-flexbox;display:flex;min-height:100vh;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.off-canvas-container .wrapper{-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}.icon{vertical-align:bottom}@font-face{font-family:Born;src:url(../assets/fonts/Born/Born.eot);src:url(../assets/fonts/Born/Born.woff2) format("woff2"),url(../assets/fonts/Born/Born.woff) format("woff"),url(../assets/fonts/Born/Born.ttf) format("truetype"),url(../assets/fonts/Born/Born.svg) format("svg"),url(../assets/fonts/Born/Born.eot?) format("embedded-opentype");font-weight:400;font-style:normal}body{color:#222;font-size:19px;font-weight:300;font-family:Born,Georgia,serif;line-height:32px;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}h1,h2,h3,h4,h5,h6{font-family:Born,Georgia,serif;font-size:19px;font-weight:300;margin:0 0 25px}@media only screen and (max-width:40em){h1,h2,h3,h4,h5,h6{font-size:16px}}h1 a,h2 a,h3 a,h4 a,h5 a,h6 a{text-decoration:none}.post-content h1{font-size:32px}.post-content h2{font-size:28px}.post-content h3{font-size:26px}.post-content h4{font-size:22px}.post-content h5{font-size:19px}.post-content ol,.post-content p,.post-content ul{font-size:19px;margin-bottom:25px}.post-content li{margin:0 0 13px}p{margin:0 0 32px}p.font-medium{margin:0 0 25px}p.font-small{margin:0 0 22px}p.font-tiny{margin:0 0 19px}@media only screen and (max-width:40em){p{margin:0 0 25px}}blockquote{margin:0;padding:0 64px 0 64px;font-style:italic}@media only screen and (max-width:40em){blockquote{padding:0 44px 0 44px}}hr{border:0;height:1px;background-color:#ecf0f1;margin:0 0 32px}@media only screen and (max-width:40em){hr{margin:0 0 25px}}ol,ul{margin:0 0 32px}ol ol,ol ul,ul ol,ul ul{margin:0}@media only screen and (max-width:40em){ol,ul{margin:0 0 25px}}a{color:#222;-webkit-transition:.4s;transition:.4s}a:visited{color:#222}a:hover{color:#7e7e7e}a:active{color:#222}a.custom{text-decoration:none}.box{padding-bottom:25px;margin-bottom:25px;overflow:hidden;border-bottom:1px solid #ecf0f1}@media only screen and (min-width:64.063em){.box{padding-bottom:32px;margin-bottom:32px}}.box__icon{float:left;width:32px;margin-right:10.66667px}.box__title{margin:0;font-weight:300;line-height:25px}@media only screen and (min-width:40.063em){.box__body{overflow:hidden}}.box__text{margin-top:11px;margin-bottom:0;font-size:14px;line-height:22px}.box--author{padding:25px;background-color:#fafafa}@media only screen and (min-width:64.063em){.box--author{padding:32px}}.box a{text-decoration:none}iframe,img{display:block}img{height:auto;max-width:100%}.post-content .fluid-width-video-wrapper,.post-content .twitter-tweet,.post-content iframe,.post-content img{margin-bottom:25px!important}@media only screen and (max-width:40em){.post-content .fluid-width-video-wrapper,.post-content .twitter-tweet,.post-content iframe,.post-content img{margin-bottom:22px}}.post-content p img{margin-bottom:0}.CoverImage{max-height:600px;max-width:100%;background-position:50%;background-repeat:no-repeat;background-size:cover}.post__tags{margin-bottom:28px;font-size:14px}.post__tags a{padding:3px 11px;margin:4px 8px 4px 0;display:inline-block;font-size:12px;line-height:22px;color:#7e7e7e;border:1px solid #ecf0f1;text-decoration:none;-webkit-transition:.4s;transition:.4s}.post__tags a:before{content:"#";padding-right:2px}.post__tags a:hover{color:#222;border-color:#222}.heading{padding-bottom:13px;margin-bottom:32px;font-size:16px;line-height:22px;letter-spacing:1px;border-bottom:1px solid #ecf0f1}code,pre{font-family:Courier,monospace;background-color:#fafafa}pre{overflow:auto;margin-top:0;margin-bottom:32px;padding:32px;font-size:16px;white-space:pre-wrap;word-wrap:break-word}@media only screen and (max-width:40em){pre{margin-bottom:22px;padding:25px}}p code{padding:3px 6px}.row{margin:0 auto;padding-left:13px;padding-right:13px;max-width:1100px}.row:after,.row:before{display:table;clear:both;content:" "}.row .row{padding:0;margin-right:-13px;margin-left:-13px}@media only screen and (min-width:64.063em){.row .row{margin-right:-16px;margin-left:-16px}}@media only screen and (min-width:64.063em){.row{padding-left:16px;padding-right:16px}}.column{position:relative;float:left;padding-right:13px;padding-left:13px;width:100%}@media only screen and (min-width:64.063em){.column{padding-right:16px;padding-left:16px}}.column--center{float:none;margin:0 auto}@media only screen{.small-1{width:8.33333%}.small-2{width:16.66667%}.small-3{width:25%}.small-4{width:33.33333%}.small-5{width:41.66667%}.small-6{width:50%}.small-7{width:58.33333%}.small-8{width:66.66667%}.small-9{width:75%}.small-10{width:83.33333%}.small-11{width:91.66667%}.small-12{width:100%}}@media only screen and (min-width:40.063em){.medium-1{width:8.33333%}.medium-2{width:16.66667%}.medium-3{width:25%}.medium-4{width:33.33333%}.medium-5{width:41.66667%}.medium-6{width:50%}.medium-7{width:58.33333%}.medium-8{width:66.66667%}.medium-9{width:75%}.medium-10{width:83.33333%}.medium-11{width:91.66667%}.medium-12{width:100%}}@media only screen and (min-width:64.063em){.large-1{width:8.33333%}.large-2{width:16.66667%}.large-3{width:25%}.large-4{width:33.33333%}.large-5{width:41.66667%}.large-6{width:50%}.large-7{width:58.33333%}.large-8{width:66.66667%}.large-9{width:75%}.large-10{width:83.33333%}.large-11{width:91.66667%}.large-12{width:100%}}input[type=email],input[type=number],input[type=tel],input[type=text],textarea{width:100%;max-width:100%;margin-bottom:0;display:inline-block;border:1px solid #222;margin-bottom:8px;padding:6px 11px;font-family:Born,Georgia,serif;font-size:14px;line-height:25px;letter-spacing:1px;outline:0;background:0 0;-webkit-appearance:none;-moz-appearance:none;appearance:none;border-radius:0;-webkit-transition:.4s;transition:.4s}@media only screen and (min-width:64.063em){input[type=email],input[type=number],input[type=tel],input[type=text],textarea{padding:8px 16px}}input[type=email]:focus,input[type=number]:focus,input[type=tel]:focus,input[type=text]:focus,textarea:focus{border:1px solid #7e7e7e}.button{display:inline-block;text-align:center;padding:8px 16px;font-family:Born,Georgia,serif;font-size:12px;line-height:25px;letter-spacing:1px;border:0;border-radius:0;text-decoration:none;color:#fff;background-color:#222;-webkit-transition:.4s;transition:.4s}.button:active,.button:focus,.button:hover{color:#fff;background-color:#7e7e7e}.button:visited{color:#fff}.button--expand{width:100%}.button--twitter{color:#fff;background-color:#55acee}.button--twitter .icon{margin-right:5px;vertical-align:middle;fill:#fff}.button--twitter:hover{color:#fff;background-color:#1e8bc3}@-webkit-keyframes spin{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.icon{position:relative;display:inline-block;width:25px;height:25px;overflow:hidden;fill:currentColor}.icon__cnt{width:100%;height:100%;background:inherit;fill:inherit;pointer-events:none;-webkit-transform:translateX(0);transform:translateX(0);-ms-transform:translate(.5px,-.3px)}.icon--m{width:50px;height:50px}.icon--l{width:100px;height:100px}.icon--xl{width:150px;height:150px}.icon--xxl{width:200px;height:200px}.icon__spinner{position:absolute;top:0;left:0;width:100%;height:100%}.icon--ei-spinner .icon__spinner,.icon--ei-spinner-2 .icon__spinner{-webkit-animation:spin 1s steps(12) infinite;animation:spin 1s steps(12) infinite}.icon--ei-spinner-3 .icon__spinner{-webkit-animation:spin 1.5s linear infinite;animation:spin 1.5s linear infinite}.icon--ei-sc-facebook{fill:#3b5998}.icon--ei-sc-github{fill:#333}.icon--ei-sc-google-plus{fill:#dd4b39}.icon--ei-sc-instagram{fill:#3f729b}.icon--ei-sc-linkedin{fill:#0976b4}.icon--ei-sc-odnoklassniki{fill:#ed812b}.icon--ei-sc-skype{fill:#00aff0}.icon--ei-sc-soundcloud{fill:#f80}.icon--ei-sc-tumblr{fill:#35465c}.icon--ei-sc-twitter{fill:#55acee}.icon--ei-sc-vimeo{fill:#1ab7ea}.icon--ei-sc-vk{fill:#45668e}.icon--ei-sc-youtube{fill:#e52d27}.icon--ei-sc-pinterest{fill:#bd081c}.icon--ei-sc-telegram{fill:#08c}.post-card{margin-bottom:25px;padding-bottom:25px;border-bottom:1px solid #ecf0f1}.post-card__header{margin-bottom:16px}.post-card__image{margin-bottom:16px;-webkit-transition:.4s;transition:.4s}@media only screen and (max-width:40em){.post-card__image{margin-bottom:13px}}.post-card__title{margin-top:0;margin-bottom:0;line-height:25px}.post-card__title a{display:block;border-bottom:none;-webkit-transition:.4s;transition:.4s}.post-card__title a:hover{color:#a60505}.post-card__meta{margin-bottom:8px;font-size:12px;line-height:22px;color:#7e7e7e}.post-card__meta a{color:#7e7e7e;text-decoration:none}.post-card:hover .post-card__image{opacity:.9}.post-card:hover .post-card__title a{color:#a60505}.post-card--featured__icon{position:absolute;bottom:8px;left:8px;fill:#fff}@media only screen and (min-width:64.063em){.post-card{margin-bottom:32px;padding-bottom:32px}}.post--first{width:100%}@media only screen and (min-width:40.063em){.post--first .post-card{position:relative}.post--first .post-card__info{display:table;position:absolute;top:50%;width:70%;z-index:100;left:96px;-webkit-transform:translate(0,-50%);transform:translate(0,-50%)}}@media only screen and (min-width:40.063em) and (min-width:64.063em){.post--first .post-card__info{width:50%}}@media only screen and (min-width:40.063em){.post--first .post-card__meta{color:#fff;display:table-footer-group}.post--first .post-card__meta a{color:#fff}.post--first .post-card__image{position:relative;z-index:100;margin-bottom:0;outline:2px solid rgba(255,255,255,.4);outline-offset:-10.66667px}.post--first .post-card__image:after{position:absolute;top:0;height:100%;width:100%;content:"";background:rgba(0,0,0,.15)}.post--first .post-card__title{font-size:28px;line-height:38px;color:#fff}.post--first .post-card__title a{color:#fff}}@media only screen and (min-width:40.063em) and (min-width:64.063em){.post--first .post-card__title{font-size:38px;line-height:44px}}@media only screen and (min-width:40.063em){.post--first .post-card--featured__icon{bottom:16px;left:16px}.post--first .post-card:hover .post-card__title a{color:#fff}.post--first .post-card:hover .post-card__image{outline:2px solid rgba(255,255,255,.8)}}.post-list{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;display:-webkit-flex;-webkit-flex-wrap:wrap}.post-list .post-card-wrap{display:-webkit-box;display:-ms-flexbox;display:flex;display:-webkit-flex}.post-list .post-card{width:100%}.share-list{display:-webkit-box;display:-ms-flexbox;display:flex;padding:0;border:1px solid #ecf0f1;margin-bottom:32px;line-height:22px;list-style:none}.share-list li{-webkit-box-flex:1;-ms-flex:1;flex:1;text-align:center;margin:0;border-right:1px solid #ecf0f1}.share-list li:last-child{border-right:0}.share-list__link{display:block;padding:8px;font-size:14px;-webkit-transition:.4s;transition:.4s}.share-list__link:hover{background-color:#fafafa}.share-list__link:hover .share-list__icon--twitter{fill:#55acee}.share-list__link:hover .share-list__icon--facebook{fill:#3b5998}.share-list__link:hover .share-list__icon--google{fill:#dc4e41}.share-list__icon{fill:#7e7e7e}@media only screen and (max-width:40em){.share-list{margin-bottom:25px}}.FlexEmbed{display:block;overflow:hidden;position:relative}.FlexEmbed:before{content:"";display:block;width:100%}.FlexEmbed--3by1:before{padding-bottom:33.33333%}.FlexEmbed--2by1:before{padding-bottom:50%}.FlexEmbed--16by9:before{padding-bottom:56.25%}.FlexEmbed--4by3:before{padding-bottom:75%}.navigation li{display:inline-block;margin-right:20px;font-size:14px;line-height:32px}@media only screen and (max-width:64em){.navigation li{display:block;margin-right:0}}.navigation li:last-child{margin-right:0}.navigation li.nav-current a{color:#7e7e7e}.home-template .navigation li.nav-current a:not(:hover){color:#222}.navigation a{-webkit-transition:.4s;transition:.4s;text-decoration:none}@media only screen and (max-width:64em){.navigation a{display:block;padding-top:8px;padding-bottom:8px;border-bottom:1px solid #ecf0f1}}@media only screen and (max-width:64em){.navigation{margin-bottom:8px}}.social-nav{text-align:right}.social-nav .icon{vertical-align:middle}@media only screen and (min-width:64.063em){.social-nav .icon{vertical-align:-moz-middle-with-baseline;vertical-align:-webkit-baseline-middle}}.social-nav li{display:inline-block}@media only screen and (max-width:64em){.social-nav{text-align:center}}.pagination{clear:both;font-size:12px;line-height:25px}.pagination .icon,.pagination span{position:relative}.pagination .newer-posts{float:left;text-align:left}.pagination .newer-posts span{left:-16px}.pagination .newer-posts .icon{left:-8.33333px}.pagination .older-posts{float:right;text-align:right}.pagination .older-posts span{right:-16px}.pagination .older-posts .icon{right:-8.33333px}.pagination a{text-decoration:none;text-transform:uppercase;letter-spacing:.2em;-webkit-transition:.4s;transition:.4s}.post-navigation{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.post-navigation:last-child .post-card{border-bottom:0;padding-bottom:0}@media only screen and (min-width:40.063em){.post-navigation .post-card{border-bottom:0;padding-bottom:0}}.post-navigation:before{position:absolute;z-index:1;content:"";top:16px;padding:0 16px;font-size:14px;color:#7e7e7e;background-color:rgba(255,255,255,.9);-webkit-transition:.4s;transition:.4s}.post-navigation.prev:before{left:32px;content:"Previous Story"}.post-navigation.next:before{right:32px;content:"Next Story"}.post-navigation:hover:before{background-color:#fff}.logo{display:block;margin-bottom:0;line-height:32px}@media only screen and (max-width:40em){.logo{line-height:25px}}.logo a{-webkit-transition:.4s;transition:.4s;text-decoration:none;letter-spacing:1px}.logo a:hover{color:#7e7e7e}.logo__img{max-height:25px;vertical-align:middle}@media only screen and (min-width:40.063em){.logo__img{max-height:32px}}.site-header{position:relative;padding:13px 0;border-bottom:1px solid #ecf0f1;line-height:25px}.site-header__navigation li{display:inline-block;margin-right:20px;font-size:14px;line-height:32px}@media only screen and (max-width:40em){.site-header__navigation li{display:block;margin-right:0}}.site-header__navigation a{-webkit-transition:.4s;transition:.4s;text-decoration:none}@media only screen and (max-width:40em){.site-header__navigation a{display:block;padding-top:8px;padding-bottom:8px;border-bottom:1px solid #ecf0f1}}@media only screen and (max-width:40em){.site-header__navigation{margin-bottom:8px}}.site-header__social-nav{text-align:right}.site-header__social-nav .icon{vertical-align:middle}@media only screen and (min-width:64.063em){.site-header__social-nav .icon{vertical-align:-moz-middle-with-baseline;vertical-align:-webkit-baseline-middle}}.site-header__social-nav li{display:inline-block}@media only screen and (max-width:40em){.site-header__social-nav{text-align:center}}@media only screen and (min-width:64.063em){.site-header{padding:16px 0}}.post-template .site-header{border-bottom:0}.off-canvas-toggle{display:none}@media only screen and (max-width:64em){.off-canvas-toggle{display:block;position:absolute;top:50%;right:19px;-webkit-transform:translateY(-50%);transform:translateY(-50%);font-size:14px;cursor:pointer}}@media only screen and (max-width:64em){body,html{overflow-x:hidden}.off-canvas-content{position:fixed;top:0;right:0;width:200px;height:100%;background-color:#fff;border-left:1px solid #ecf0f1;-webkit-transform:translate3d(0,0,0) translateX(200px);transform:translate3d(0,0,0) translateX(200px);-webkit-transition:all .4s cubic-bezier(.16,.63,.45,.98) 0s;transition:all .4s cubic-bezier(.16,.63,.45,.98) 0s}.off-canvas-container{-webkit-transform:translate3d(0,0,0) translateX(0);transform:translate3d(0,0,0) translateX(0);-webkit-transition:all .4s cubic-bezier(.16,.63,.45,.98) 0s;transition:all .4s cubic-bezier(.16,.63,.45,.98) 0s}.off-canvas-container.is-active{-webkit-transform:translate3d(0,0,0) translateX(-200px);transform:translate3d(0,0,0) translateX(-200px)}}.site-footer{padding-top:64px;background-color:#ecf0f1}@media only screen and (max-width:40em){.site-footer{padding-top:32px}}@media only screen and (max-width:40em){.site-footer__section{margin-bottom:16px}.site-footer__section:last-child{margin-bottom:0}}.site-footer a{text-decoration:none;-webkit-transition:.4s;transition:.4s}.site-footer__nav li{font-size:12px}.site-footer__nav a{display:block}.site-footer__nav .icon{margin-right:8.33333px}.social-icons{margin:0;padding:0}.social-icons .icon{fill:#222;-webkit-transition:.4s;transition:.4s}.social-icons .icon:hover{fill:#7e7e7e}@media only screen and (min-width:64.063em){.social-icons .icon{position:relative;top:-4px}}.social-icons a:hover .icon{fill:#7e7e7e}.site-footer__top{padding-bottom:32px}.site-footer__bottom{border-top:1px solid #dadfe1;padding-top:16px;padding-bottom:16px}.site-footer__bottom .poweredby{text-align:right}@media only screen and (max-width:40em){.site-footer__bottom{text-align:center}.site-footer__bottom .poweredby{padding-top:8px;text-align:center}}.author-image{float:left;margin:0;margin-right:25px}.author-image .img{height:96px;width:96px;background-position:center;background-size:cover;border-radius:100%}@media only screen and (max-width:40em){.author-image .img{height:64px;width:64px}}@media only screen and (min-width:64.063em){.author-image{margin-right:32px}}.author-meta{text-indent:-1px}.author-meta .icon{fill:#222;-webkit-transition:.4s;transition:.4s}.author-meta a .icon:hover{fill:#7e7e7e}.post{margin-bottom:32px}.post__header{margin-bottom:13px}.post__title{margin-bottom:13px;font-size:19px}@media only screen and (min-width:64.063em){.post__title{font-size:32px;line-height:50px}}.post__date{font-size:14px;line-height:22px;color:#7e7e7e}.search-form-container{position:fixed;top:0;right:0;bottom:0;left:0;z-index:101;white-space:nowrap;background:#fff;opacity:0;visibility:hidden;-webkit-transition:all .4s ease-in-out;transition:all .4s ease-in-out;-webkit-transform:translate(0,-100%) scale(0,0);transform:translate(0,-100%) scale(0,0)}.search-form-container__close{position:absolute;top:32px;right:32px;cursor:pointer;-webkit-transition:.4s;transition:.4s;fill:#222}.search-form-container__close:hover{fill:#7e7e7e;-webkit-transform:rotate(90deg);transform:rotate(90deg)}@media only screen and (max-width:40em){.search-form-container__close{top:16px;right:16px}}.search-form-container.is-active{opacity:1;visibility:visible;-webkit-transform:translate(0,0) scale(1,1);transform:translate(0,0) scale(1,1)}.search-form{margin-bottom:16px}.search-form__field{padding:0;width:100%;outline:0;font-size:38px;line-height:64px;border:0;border-bottom:1px solid #ecf0f1}@media only screen and (max-width:40em){.search-form__field{font-size:28px;line-height:44px}}.search-form__field:focus{border:0;border-bottom:1px solid #ecf0f1}.search-form__submit{display:none}.search-form__fieldset{border:0;margin-top:64px;padding:0}.search-results{display:none;height:80vh;overflow:auto;white-space:normal}.search-results .heading{margin-right:16px;margin-bottom:16px;color:#7e7e7e}.search-results__item{margin-bottom:16px;margin-right:16px;padding-bottom:16px;border-bottom:1px solid #ecf0f1}.search-results__item__title{display:block;text-decoration:none;font-size:16px;line-height:25px}.search-results__item__date{font-size:12px;line-height:22px;color:#7e7e7e}.widget{margin-bottom:32px;border:1px solid #ecf0f1}.widget__title{padding:25px 25px 22px;margin-bottom:0;font-size:16px;line-height:13px;letter-spacing:1px;border-bottom:1px solid #ecf0f1}@media only screen and (min-width:64.063em){.widget__title{padding:25px 32px 22px 32px}}.widget__body{padding:25px;font-size:16px}.widget__body .post-card:last-child{padding-bottom:0;margin-bottom:0;border-bottom:0}.widget__body iframe{display:block!important}@media only screen and (min-width:64.063em){.widget__body{padding:32px}}@media only screen and (min-width:64.063em){.widget__body--social-icons{padding-bottom:25px}}.widget .twitter-widget{padding:22px;word-wrap:break-word}.widget .twitter-widget ul{margin:0;padding:0;list-style:none;font-size:14px}.widget .twitter-widget ul li{padding-bottom:16px;margin-bottom:10.66667px;border-bottom:1px solid #ecf0f1}.widget .twitter-widget ul li a{text-decoration:none;font-size:12px;color:#7e7e7e}.widget .twitter-widget ul li a:hover{color:#222}.widget .twitter-widget ul li .tweet{margin-bottom:4px;line-height:32px}.widget .twitter-widget ul li .timePosted{margin-bottom:0;font-size:12px;line-height:19px}.widget .twitter-widget ul li .timePosted a{color:#7e7e7e}.widget .twitter-widget ul li:last-child{border-bottom:0}@media only screen and (min-width:64.063em){.widget .twitter-widget{padding:22px 32px 32px 32px}}.sidebar-social-icons li{float:left;margin-bottom:8px;margin-right:8px}.sidebar-social-icons li a{display:block;padding:0 8px;border:1px solid #ecf0f1;-webkit-transition:.4s;transition:.4s}.sidebar-social-icons li a:hover{border:1px solid #222}.sidebar-social-icons li a:hover .icon{fill:#7e7e7e}@media only screen and (min-width:64.063em){.recent-posts .post-card{position:relative;padding-bottom:0}.recent-posts .post-card__image{position:relative;z-index:100;margin-bottom:0;outline:2px solid rgba(255,255,255,.4);outline-offset:-10.66667px}.recent-posts .post-card__image:after{position:absolute;top:0;height:100%;width:100%;content:'';background:rgba(0,0,0,.4)}.recent-posts .post-card__title{position:absolute;top:50%;left:50%;width:100%;z-index:100;padding:25px;text-align:center;font-size:16px;line-height:25px;color:#fff;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.recent-posts .post-card__title a{color:#fff}.recent-posts .post-card:hover .post-card__title a{color:#fff}.recent-posts .post-card:hover .post-card__image{outline:2px solid rgba(255,255,255,.8)}}.grey-bg{background-color:#fafafa}.list-bare,.no-bullets{list-style:none}.bullets-inside{list-style:inside}.list-bare{margin:0;padding:0}.text-left{text-align:left}.text-right{text-align:right}.text-center{text-align:center}.text-justify{text-align:justify}.inline{display:inline}.block{display:block}.inline-block{display:inline-block}.hide{display:none}.left{float:left}.right{float:right}.hidden{border:0 none;clip:rect(1px,1px,1px,1px);height:1px;overflow:hidden;padding:0;position:absolute!important;width:1px}.clearfix:after,.clearfix:before{content:" ";display:table}.clearfix:after{clear:both}.light{font-weight:300}.regular{font-weight:400}.bold{font-weight:700}.italic{font-style:italic}.cap{text-transform:capitalize}.uppercase{text-transform:uppercase}.ell{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.font-base{font-size:19px}.font-medium{font-size:16px;line-height:25px}.font-small{font-size:14px;line-height:22px}.font-tiny{font-size:12px;line-height:19px}
</style>  
  <link rel="stylesheet" type="text/css" href="../assets/css/prism.css?v=0a61b1323b">
  <link rel="stylesheet" type="text/css" href="../assets/css/custom.css?v=0a61b1323b">
   
  <link rel="canonical" href="http://quadrate-tech.com/jpa-and-hibernate-problems/">
    <meta name="referrer" content="origin-when-cross-origin">
    
    <meta property="og:site_name" content="quadrate-tech - Practical Coding Courses, Tutorials and Examples Series">
    <meta property="og:type" content="article">
    <meta property="og:title" content="JPA and Hibernate Problems">
    <meta property="og:description" content="On the one hand, JPA and Hibernate provide an abstraction to do the CRUD operations against various databases, enable us to develop database applications quickly On the other hand, JPA and Hibernate also create some performance issues that we need to be taken care of This article will explore some">
    <meta property="og:url" content="http://quadrate-tech.com/jpa-and-hibernate-problems/">
    <meta property="og:image" content="http://quadrate-tech.com/content/images/2020/04/SpringDataJPA_CommonProblems.png">
    <meta property="article:published_time" content="2020-04-22T15:23:37.000Z">
    <meta property="article:modified_time" content="2020-04-26T09:24:25.000Z">
    <meta property="article:tag" content="JPA and Hibernate">
    <meta property="article:tag" content="Spring Boot">
    
    <meta property="article:publisher" content="https://www.facebook.com/quadrate-tech">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="JPA and Hibernate Problems">
    <meta name="twitter:description" content="On the one hand, JPA and Hibernate provide an abstraction to do the CRUD operations against various databases, enable us to develop database applications quickly On the other hand, JPA and Hibernate also create some performance issues that we need to be taken care of This article will explore some">
    <meta name="twitter:url" content="http://quadrate-tech.com/jpa-and-hibernate-problems/">
    <meta name="twitter:image" content="http://quadrate-tech.com/content/images/2020/04/SpringDataJPA_CommonProblems.png">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Giau Ngo">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="JPA and Hibernate, Spring Boot">
    <meta name="twitter:site" content="@quadrate-tech">
    <meta name="twitter:creator" content="@giaunv">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "quadrate-tech - Practical Coding Courses, Tutorials and Examples Series",
        "logo": "http://quadrate-tech.com/content/images/2016/06/k.png"
    },
    "author": {
        "@type": "Person",
        "name": "Giau Ngo",
        "image": "http://quadrate-tech.com/content/images/2015/11/vinhkim_2.png",
        "url": "http://quadrate-tech.com/author/giau/",
        "sameAs": [
            "https://github.com/giaunv",
            "https://twitter.com/giaunv"
        ],
        "description": "Giau Ngo is a software engineer, creator of Hello Koding. Get in touch with him on Twitter, GitHub and LinkedIn"
    },
    "headline": "JPA and Hibernate Problems",
    "url": "http://quadrate-tech.com/jpa-and-hibernate-problems/",
    "datePublished": "2020-04-22T15:23:37.000Z",
    "dateModified": "2020-04-26T09:24:25.000Z",
    "image": "http://quadrate-tech.com/content/images/2020/04/SpringDataJPA_CommonProblems.png",
    "keywords": "JPA and Hibernate, Spring Boot",
    "description": "On the one hand, JPA and Hibernate provide an abstraction to do the CRUD operations against various databases, enable us to develop database applications quickly On the other hand, JPA and Hibernate also create some performance issues that we need to be taken care of This article will explore some"
}
    </script>

    <script type="text/javascript" src="../shared/ghost-url.min.js?v=0a61b1323b"></script>
<script type="text/javascript">
ghost.init({
	clientId: "ghost-frontend",
	clientSecret: "f10f74c0e8dc"
});
</script>
    <meta name="generator" content="Ghost 0.9">
    <link rel="alternate" type="application/rss+xml" title="quadrate-tech - Practical Coding Courses, Tutorials and Examples Series" href="http://quadrate-tech.com/rss/">
    <script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-8680819658304309",
          enable_page_level_ads: true
     });
</script>
</head>
<body class="post-template tag-jpa tag-spring-boot">

	<div class="off-canvas-container">
    <header class="site-header">

  <div class="row">
    <div class="column small-10 large-1">
      <a class="logo" href="http://quadrate-tech.com"><img class="logo__img" src="../content/images/2016/06/k.png" alt="quadrate-tech - Practical Coding Courses, Tutorials and Examples Series"></a>
    </div>

    <label class="off-canvas-toggle"><span data-icon="ei-navicon" data-size="s"></span></label>

    <div class="off-canvas-content">

      <div class="column large-9">
        <nav class="navigation">
          <ul class="list-bare text-center">
              <li class="nav-courses ">
    <a href="http://quadrate-tech.com/tag/courses/">Courses</a>
  </li>
  <li class="nav-java ">
    <a href="http://quadrate-tech.com/tag/java/">Java</a>
  </li>
  <li class="nav-spring-boot ">
    <a href="http://quadrate-tech.com/tag/spring-boot/">Spring Boot</a>
  </li>
  <li class="nav-security-with-spring ">
    <a href="http://quadrate-tech.com/tag/security/">Security with Spring</a>
  </li>
  <li class="nav-jpa-and-hibernate ">
    <a href="http://quadrate-tech.com/tag/jpa/">JPA and Hibernate</a>
  </li>
  <li class="nav-rest-with-spring ">
    <a href="http://quadrate-tech.com/tag/restful/">REST with Spring</a>
  </li>
  <li class="nav-golang ">
    <a href="http://quadrate-tech.com/tag/golang/">Golang</a>
  </li>
  <li class="nav-data-structure ">
    <a href="http://quadrate-tech.com/tag/data-structure/">Data Structure</a>
  </li>
  <li class="nav-algorithm ">
    <a href="http://quadrate-tech.com/tag/algorithm/">Algorithm</a>
  </li>

            <!--<li><a class="subscribe-button icon-feed" href="http://quadrate-tech.com/rss/">RSS</a></li>-->
          </ul>
        </nav>
      </div>

      <div class="column large-2">
        <ul class="social-nav social-icons list-bare">
            <li>
              <a href="https://github.com/giaunv" target="_blank">
                <span data-icon="ei-sc-github" data-size="s"></span>
              </a>
            </li> 
            <li>
              <a href="https://www.facebook.com/quadrate-tech" target="_blank">
                <span data-icon="ei-sc-facebook" data-size="s"></span>
              </a>
            </li>
            <li>
              <a href="https://twitter.com/quadrate-tech" target="_blank">
                <span data-icon="ei-sc-twitter" data-size="s"></span>
              </a>
            </li>
          <li>
              <a href="https://www.linkedin.com/company/quadrate-tech" target="_blank">
                <span data-icon="ei-sc-linkedin" data-size="s"></span>
              </a>
            </li>
          <li>
            <a class="toggle-search-button" href="index.html#">
              <span data-icon="ei-search" data-size="s"></span>
            </a>
          </li>
        </ul>
      </div>

    </div> 

  </div> 

</header>

<div class="search-form-container">

  <form class="search-form">
    <fieldset class="search-form__fieldset">
      <div class="row">
        <div class="column column--center large-8">
          <script>
            (function() {
              var cx = 'partner-pub-8680819658304309:3377321621';
              var gcse = document.createElement('script');
              gcse.type = 'text/javascript';
              gcse.async = true;
              gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
              var s = document.getElementsByTagName('script')[0];
              s.parentNode.insertBefore(gcse, s);
              document.write("<gcse:searchbox-only></gcse:searchbox-only>");
            })();
          </script>
	  <!--<input class="search-form__field" placeholder="Type to Search" autofocus>
          <input class="search-form__submit" type="submit" value="search">-->
        </div>
      </div>
    </fieldset>
  </form>

  <div class="row">
    <div class="column column--center large-8">
      <searchresults class="search-results"></searchresults>
      <!--<div class="search-results"></div>-->
    </div>
  </div>

  <div data-icon="ei-close" data-size="s" class="close-search-button search-form-container__close"></div>
</div>


    


  <div class="wrapper-ad">
    <div class="sponsors-head">
      <!-- ad_top -->
      <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8680819658304309" data-ad-slot="2439095734" data-ad-format="auto" data-full-width-responsive="true"></ins>
      <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
    </div>
  </div>


  <div class="wrapper">
    <div class="row">

      <div class="medium-8 large-9 column">
        <article class="post tag-jpa tag-spring-boot">

          <header class="post__header">
            <h1 class="post__title">JPA and Hibernate Problems</h1>
            <time class="post__date" datetime="2020-04-26">Last modified @ 26 April 2020</time>
          </header>

          <div class="post-content">
            <div class="post__tags">
              <a href="../tag/jpa/">JPA and Hibernate</a><a href="../tag/spring-boot/">Spring Boot</a>
            </div>

            <p>On the one hand, JPA and Hibernate provide an abstraction to do the CRUD operations against various databases, enable us to develop database applications quickly</p>

<p>On the other hand, JPA and Hibernate also create some performance issues that we need to be taken care of</p>

<p>This article will explore some common problems you may encounter when working with JPA and Hibernate in Spring Boot and Spring Data applications</p>

<p>Let's get started!</p>

<p></p><div class="hk-autoads"></div>  

<h3 id="problem1eagerfetchtype">Problem 1: EAGER FetchType</h3>

<p>There are two types of fetching strategy in JPA and Hibernate to load data for the associated (children) entities, EAGER and LAZY. While LAZY only fetches data when they are needed (at the first time accessed of the associated entities), EAGER always fetches children entities along with its parent</p>

<p>While LAZY can cause LazyInitializationException, EAGER causes Hibernate to generate and execute unnecessary SELECT SQLs to the database and so increasing the memory consumption for unnecessary data</p>

<p>Let's take a look at the following example</p>

<pre><code class="language-java">@Entity
class Company {  
    @OneToMany(fetch = FetchType.EAGER)
    private Set&lt;Employee&gt; employees;

    @OneToOne(fetch = FetchType.EAGER)
    private Address address;

    //...
}

interface CompanyRepository extends JpaRepository&lt;Company, Integer&gt; {  
    List&lt;Company&gt; findFirst10ByOrderByNameAsc();
}

@Service
class CompanyService {  
    //...

    public List&lt;String&gt; findCompanyNames() {
        List&lt;Company&gt; companies = companyRepository.findFirst10ByOrderByNameAsc();
        return companies.stream()
            .map(Company::getName)
            .collect(Collectors.toList());
    }
}
</code></pre>

<p>The above <code>findCompanyNames()</code> method only needs company names. However, besides fetching Company data, Hibernate also eagerly fetches data in the background for other EAGER FetchType associations including <code>Set&lt;Employee&gt;</code> and <code>Address</code>. The problem would become more significant when you have more EAGER associations or more entities in each</p>

<p>Apart from consuming memory for unnecessary data, EAGER FetchType can also cause the N+1 SQL problem which you can find more details in the latter part of this article</p>

<h3 id="approach1lazyfetchtype">Approach 1: LAZY FetchType</h3>

<ul>
<li><p>Avoid using EAGER fetch in JPA and Hibernate. EAGER can fix the LazyInitializationException caused by the LAZY but it creates a performance pitfall especially when you have multiple EAGER associations in the entity</p></li>
<li><p>EAGER FetchType is the default in JPA ToOne mappings (@ManyToOne, @OneToOne), make sure you change them to LAZY explicitly</p></li>
</ul>

<pre><code class="language-java">@ManyToOne(fetch = FetchType.LAZY)
private BookCategory bookCategory;

@OneToOne(fetch = FetchType.LAZY)
private BookDetail bookDetail;  
</code></pre>

<p></p><div class="hk-autoads"></div>  

<h3 id="problem2lazyinitializationexception">Problem 2: LazyInitializationException</h3>

<p>LazyInitializationException is caused by uninitialized LAZY FetchType associations when they are accessed outside the transactional context</p>

<pre><code class="language-java">@Entity
public class Quote {  
    @ManyToOne(fetch = FetchType.LAZY)
    private Author author;

    //...
}

interface QuoteRepository extends JpaRepository&lt;Quote, Integer&gt;{  
    List&lt;Quote&gt; findFirst10ByOrderByName();
}

@Service
class QuoteService  
    //...

    public List&lt;QuoteWithAuthor&gt; findQuotesWithAuthor() {
        return of(quoteRepository.findFirst10ByOrderByName());
    }

    List&lt;QuoteWithAuthor&gt; of(List&lt;Quote&gt; quotes) {
        return quotes.stream().map(q -&gt; {
            Author a = q.getAuthor();
            AuthorIdName ain = new AuthorIdName(a.getId(), a.getName());
            return new QuoteWithAuthor(q.getId(), q.getName(), ain);
        }).collect(Collectors.toList());
    }
}
</code></pre>

<p>In the above <code>findQuotesWithAuthor()</code> method, <code>LazyInitializationException</code> is thrown as the LAZY associated entity <code>author</code> is not initialized, the <code>quoteRepository.findFirst10ByOrderByName()</code> only fetchs the parent and EAGER associations then close the transaction</p>

<p>There are several ways to resolve the LazyInitializationException. However, some of them are pitfalls</p>

<h3 id="pitfall21eagerfetchtype">Pitfall 2.1: EAGER FetchType</h3>

<p>Use EAGER FetchType for the <code>author</code> association, so its data will be available along with its parent. However, this approach can create a performance pitfall as we learned in the previous section. It also can create the N+1 problem</p>

<h3 id="pitfall22transactional">Pitfall 2.2: @Transactional</h3>

<p>Add <code>@Transacional</code> annotation to <code>findQuotesWithAuthor()</code> method can keep the associations fetching executed in database transactional context (so resolving the LazyInitializationException) but it can create the N+1 problem. You can learn more about this problem in the latter part of this tutorial</p>

<h3 id="pitfall23hibernateinitializeobject">Pitfall 2.3: Hibernate.initialize(Object)</h3>

<p>Hibernate.initialize(Object) forces initialization of a proxy or persistent collection. It helps initialize LAZY FetchType associations manually but also brings some drawbacks</p>

<ul>
<li><p>It generates and executes an additional SQL against the database each time</p></li>
<li><p>It does not initialize children entities of the input object</p></li>
</ul>

<p>Try to fix the symptoms and do outside the repository (data access layer) are the common theme of pitfall approaches</p>

<p>On the opposites, the right approaches will try to do inside the repository and fix the root cause by hinting JPA and Hibernate to generate and execute only 1 SQL to fetch the necessary association's data as there are no throwing LazyInitializationException errors if all the necessary data are initialized before using</p>

<h3 id="approach21projection">Approach 2.1: Projection</h3>

<p>Spring Data can help retrieve partial view of a JPA  @Entity with interface-based or class-based projection (DTO classes)</p>

<pre><code class="language-java">interface QuoteProjection {  
    Integer getId();
    String getName();
    AuthorProjection getAuthor();
}

interface AuthorProjection {  
    Integer getId();
    String getName();
}

interface QuoteRepository extends JpaRepository&lt;Quote, Integer&gt; {  
    List&lt;QuoteProjection&gt; findFirst10ByOrderByNameDesc();
}
</code></pre>

<p>QuoteProjection and AuthorProjection are the partial views of 2 JPA entities, Quote and Author respectively</p>

<p>In <code>findFirst10ByOrderByNameDesc()</code> method of <code>QuoteRepository</code>, Spring Data JPA fetchs and converts the return data to <code>List&lt;QuoteProjection&gt;</code></p>

<h3 id="approach22entitygraph">Approach 2.2: @EntityGraph</h3>

<p>@EntityGraph annotation is used on the repository methods, providing a declarative way to fetch associations in a single query</p>

<pre><code class="language-java">interface QuoteRepository extends JpaRepository&lt;Quote, Integer&gt; {  
    @EntityGraph(attributePaths = "author")
    List&lt;Quote&gt; findFirst10ByOrderByName();
}
</code></pre>

<h3 id="approach23jpqljoinfetch">Approach 2.3: JPQL JOIN FETCH</h3>

<p>JPQL supports JOIN FETCH to fetch associations data in a single query</p>

<pre><code class="language-java">interface QuoteRepository extends JpaRepository&lt;Quote, Integer&gt; {  
    @Query(value="FROM Quote q LEFT JOIN FETCH q.author")
    List&lt;Quote&gt; findWithAuthorAndJoinFetch(Pageable pageable);
}
</code></pre>

<p></p><div class="hk-autoads"></div>  

<h3 id="problem3n1sqlstatements">Problem 3: N+1 SQL statements</h3>

<p>The N+1 SQL problem occurs on the associated (child) entities when JPA and Hibernate have to execute N additional SQLs to do the operation</p>

<p>The issue can happen on both EAGER and LAZY FetchType and on reading or deleting operation against a database</p>

<h3 id="problem31n1onselect">Problem 3.1: N+1 on SELECT</h3>

<p>Let's take a look at the following example</p>

<pre><code class="language-java">@Entity
class Company {  
    @OneToMany(fetch = LAZY, mappedBy = "company", cascade = ALL)
    private Set&lt;Employee&gt; employees;

    @OneToMany(fetch = EAGER, mappedBy = "company", cascade = ALL)
    private Set&lt;Department&gt; departments;

    //...
}

interface CompanyRepository extends JpaRepository&lt;Company, Integer&gt; {  
    List&lt;Company&gt; findFirst10ByOrderByNameAsc();
}

@Service
class CompanyService {  
    //...

    public List&lt;String&gt; findCompanyNames() {
        List&lt;Company&gt; companies = companyRepository.findFirst10ByOrderByNameAsc();
        return companies.stream()
            .map(Company::getName)
            .collect(Collectors.toList());
    }

    @Transactional
    public List&lt;CompanyIdName&gt; findCompanyIdNames() {
        return companyRepository.findFirst10ByOrderByNameAsc().stream()
            .map(CompanyIdName::of)
            .collect(Collectors.toList());
    }
}
</code></pre>

<p>Suppose you have 10 Companies and each Company has some Employees in the database. With JPA <code>show-sql</code> and Hibernate <code>generate_statistics</code> settings are enabled in your Spring Boot application properties</p>

<pre><code class="language-markup">spring.jpa.show-sql=true  
spring.jpa.properties.hibernate.generate_statistics=true  
</code></pre>

<p>When running the <code>findCompanyNames()</code> method, you may end up with the following output in the console</p>

<pre><code class="language-markup">703586 nanoseconds spent preparing 11 JDBC statements;  
3783867 nanoseconds spent executing 11 JDBC statements;  
</code></pre>

<ul>
<li>The first SQL statement is executed to load the list of 10 companies <code>List&lt;Company&gt;</code></li>
<li>The 10 consecutive SQLs, corresponding to the number of elements returned from the result of the first SQL statement, are executed to fetch the <code>Set&lt;Department&gt;</code> EAGER associations</li>
</ul>

<p>Separately, when running the <code>findCompanyIdNames()</code> method, you may end up with the following output in the console</p>

<pre><code class="language-markup">703586 nanoseconds spent preparing 21 JDBC statements;  
3783867 nanoseconds spent executing 21 JDBC statements;  
</code></pre>

<ul>
<li>The first SQL statement is executed to load the list of 10 companies <code>List&lt;Company&gt;</code></li>
<li>The 20 consecutive SQLs, corresponding to the number of elements returned from the result of the first SQL statement, are executed to fetch the EAGER <code>Set&lt;Department&gt;</code> and LAZY <code>Set&lt;Employee&gt;</code> associations</li>
</ul>

<h3 id="approach311entitygraphandprojection">Approach 3.1.1: @EntityGraph and Projection</h3>

<p>@EntityGraph annotation is used on the repository methods, providing a declarative way to fetch associations in a single query</p>

<p>Spring Data can help to retrieve partial view of a JPA  @Entity with interface-based or class-based projection (DTO classes)</p>

<pre><code class="language-java">interface CompanyProjection {  
    int getId();
    String getName();
    List&lt;EmployeeProjection&gt; getEmployees();
}

interface EmployeeProjection {  
    int getId();
    String getName();
}

@EntityGraph(attributePaths = "employees")
List&lt;CompanyProjection&gt; findFirst10ByOrderByIdDesc();  
</code></pre>

<p>CompanyProjection and EmployeeProjection are the partial views of 2 JPA entities, Company and Employee respectively</p>

<p>In <code>findFirst10ByOrderByIdDesc()</code> method, Spring Data JPA fetchs and converts the return data to <code>List&lt;CompanyProjection&gt;</code></p>

<h3 id="approach312joinfetch">Approach 3.1.2: JOIN FETCH</h3>

<p>JPQL supports JOIN FETCH to fetch associations data in a single query</p>

<pre><code class="language-java">@Query(value="FROM Company c LEFT JOIN FETCH c.employees")
List&lt;Company&gt; findWithEmployeesAndJoinFetch(Pageable pageable);  
</code></pre>

<p>Try to hint JPA and Hibernate to generate and execute only 1 SQL is the common pattern of the above approaches. Now <br>
when you trigger the <code>findFirst10ByOrderByIdDesc()</code> or <code>findWithEmployeesAndJoinFetch()</code> method, you would observe the expected output</p>

<pre><code class="language-markup">703586 nanoseconds spent preparing 1 JDBC statements;  
3783867 nanoseconds spent executing 1 JDBC statements;  
</code></pre>

<h3 id="problem32n1ondelete">Problem 3.2: N+1 on DELETE</h3>

<p>N+1 may also occur on Delete operations. Suppose you'd like to build a repository method to delete employees by a company id</p>

<pre><code class="language-java">interface EmployeeRepository extends JpaRepository&lt;Employee, Integer&gt; {  
    @Transactional
    void deleteByCompanyId(int companyId);
}
</code></pre>

<p>When triggering <code>deleteByCompanyId()</code> method and looking into the output console, you would find out that Hibernate deletes one by one employee. It generates N+1 queries to do the operation</p>

<p>The first query selects a list of employees of companies with id as <code>companyId</code></p>

<p>The second query selects company data with id as <code>companyId</code></p>

<p>Then N consecutive queries are generated and executed to delete one by one employee, N is the size of the result list of the first query</p>

<h3 id="approach32definethedeletequeryexplicitly">Approach 3.2: Define the DELETE query explicitly</h3>

<p>In the repository, define the DELETE query explicitly</p>

<pre><code class="language-java">interface EmployeeRepository extends JpaRepository&lt;Employee, Integer&gt; {  
    @Modifying
    @Transactional
    @Query("DELETE FROM Employee e WHERE e.company.id = ?1")
    void deleteInBulkByCompanyId(int companyId);

    @Transactional
    void deleteByCompanyId(int categoryId);
}
</code></pre>

<p>With the <code>deleteInBulkByCompanyId()</code> method, only 1 DELETE query is executed to delete employes in bulk instead of one by one</p>

<h3 id="conclusion">Conclusion</h3>

<p>In this article, we explored some of the common problems when using JPA and Hibernate in Spring Boot and Spring Data applications. We also learned about the pitfalls and the right approaches to resolving the issues</p>
            
            <div class="post__tags">
              <a href="../tag/jpa/">JPA and Hibernate</a><a href="../tag/spring-boot/">Spring Boot</a>
            </div>
          </div>

          <div class="love-post">Share to social</div>
<div class="share-list">
  <a class="share-list__link share-list__link-twitter" title="Share on Twitter" href="https://twitter.com/share?text=JPA%20and%20Hibernate%20Problems&amp;url=http://quadrate-tech.com/jpa-and-hibernate-problems/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
    <div data-icon="ei-sc-twitter" data-size="sm" class="share-list__icon--twitter"></div>
    <span>Twitter</span>
  </a>
  <a class="share-list__link share-list__link-facebook" title="Share on Facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://quadrate-tech.com/jpa-and-hibernate-problems/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
    <div data-icon="ei-sc-facebook" data-size="sm" class="share-list__icon--facebook"></div>
    <span>Facebook</span>
  </a>
</div>
          <!-- ad_post_end -->
          <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8680819658304309" data-ad-slot="6530098572" data-ad-format="auto" data-full-width-responsive="true"></ins>
          <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
          </script>
          <h1></h1>
          
<div class="box box--author">

  <figure class="author-image">
    <div class="img" style="background-image: url(../content/images/2015/11/vinhkim_2.png)"><span class="hidden">Giau Ngo's Picture</span></div>
  </figure>

  <div class="box__body">

    <h4 class="box__title">
      <a href="../author/giau/">Giau Ngo</a>
    </h4>

      <p class="box__text">Giau Ngo is a software engineer, creator of Hello Koding. Get in touch with him on Twitter, GitHub and LinkedIn</p>

    <div class="author-meta box__text">
        <div class="inline-block">
          <a href="https://twitter.com/giaunv" target="_blank">
            <span data-icon="ei-sc-twitter" data-size="s"></span>
          </a>
        </div>


        <div class="inline-block">
          <a href="https://github.com/giaunv" target="_blank">
            <span data-icon="ei-sc-github" data-size="s"></span>
          </a>
        </div>

      <div class="inline-block">
          <a href="https://www.linkedin.com/in/giaunv/" target="_blank">
            <span data-icon="ei-sc-linkedin" data-size="s"></span>
          </a>
        </div>

    </div>

  </div>
</div>
          <div class="row recommend">
  <ins class="adsbygoogle" style="display:block" data-ad-format="autorelaxed" data-ad-client="ca-pub-8680819658304309" data-ad-slot="6831036115"></ins>
  <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>          <section class="disqus">
  <h4 class="heading">Comments</h4>                          
  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'http://quadrate-tech.com/jpa-and-hibernate-problems/';
      this.page.identifier = '218';
    };

    (function() {
    var d = document, s = d.createElement('script');
    s.src = '//quadrate-tech.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
  </script>  
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>

        </article>
      </div>

      <div class="medium-4 large-3 column sidebar">
          

  <aside class="widget">
  <h3 class="widget__title">Get in touch</h3>
  <div class="widget__body widget__body--social-icons">
    <ul class="social-icons sidebar-social-icons list-bare clearfix">
        <li>
          <a href="https://github.com/giaunv" target="_blank">
            <span data-icon="ei-sc-github" data-size="s"></span>
          </a>
        </li>
        <li>
          <a href="https://www.facebook.com/quadrate-tech" target="_blank">
            <span data-icon="ei-sc-facebook" data-size="s"></span>
          </a>
        </li>
        <li>
          <a href="https://twitter.com/quadrate-tech" target="_blank">
            <span data-icon="ei-sc-twitter" data-size="s"></span>
          </a>
        </li>

      <li>
          <a href="https://www.linkedin.com/company/quadrate-tech" target="_blank">
            <span data-icon="ei-sc-linkedin" data-size="s"></span>
          </a>
        </li>
    </ul>
  </div>
</aside>




  <aside class="widget sponsors">
  <!-- sidebar1 -->
  <ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-8680819658304309" data-ad-slot="4567639390"></ins>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</aside>

<aside class="widget sponsors">
  <!-- sidebar2 -->
  <ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-8680819658304309" data-ad-slot="3362368937"></ins>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</aside>

<aside class="widget sponsors">
  <!-- sidebar3 -->
  <ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-8680819658304309" data-ad-slot="6726898877"></ins>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</aside>

<aside class="widget sponsors">
    <!-- sidebar300-600 -->
    <ins class="adsbygoogle" style="display:inline-block;width:300px;height:600px" data-ad-client="ca-pub-8680819658304309" data-ad-slot="3007685685"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</aside>





      </div>

    </div>

  </div>






    <footer class="site-footer">

  <div class="row">
    <div class="column large-12">
      <div class="site-footer__top">
        <div class="row">

          <div class="site-footer__section column medium-3 large-3  medium-4 large-4 ">
            <a href="http://quadrate-tech.com">quadrate-tech - Practical Coding Courses, Tutorials and Examples Series</a>
          </div>

          <div class="site-footer__section column medium-3 large-3  medium-4 large-4 ">
            <nav>
              <ul class="list-bare site-footer__nav">
                  <li class="nav-courses ">
    <a href="http://quadrate-tech.com/tag/courses/">Courses</a>
  </li>
  <li class="nav-java ">
    <a href="http://quadrate-tech.com/tag/java/">Java</a>
  </li>
  <li class="nav-spring-boot ">
    <a href="http://quadrate-tech.com/tag/spring-boot/">Spring Boot</a>
  </li>
  <li class="nav-security-with-spring ">
    <a href="http://quadrate-tech.com/tag/security/">Security with Spring</a>
  </li>
  <li class="nav-jpa-and-hibernate ">
    <a href="http://quadrate-tech.com/tag/jpa/">JPA and Hibernate</a>
  </li>
  <li class="nav-rest-with-spring ">
    <a href="http://quadrate-tech.com/tag/restful/">REST with Spring</a>
  </li>
  <li class="nav-golang ">
    <a href="http://quadrate-tech.com/tag/golang/">Golang</a>
  </li>
  <li class="nav-data-structure ">
    <a href="http://quadrate-tech.com/tag/data-structure/">Data Structure</a>
  </li>
  <li class="nav-algorithm ">
    <a href="http://quadrate-tech.com/tag/algorithm/">Algorithm</a>
  </li>

                <!--<li><a class="subscribe-button icon-feed" href="http://quadrate-tech.com/rss/">RSS</a></li>-->
              </ul>
            </nav>
          </div>

          <div class="site-footer__section column medium-3 large-3  medium-4 large-4 ">
            <ul class="site-footer__nav social-icons list-bare">
                <li>
                  <a href="https://github.com/giaunv" target="_blank">
                    <span data-icon="ei-sc-github" data-size="s"></span>
                    GitHub
                  </a>
                </li>
                <li>
                  <a href="https://www.facebook.com/quadrate-tech" target="_blank">
                    <span data-icon="ei-sc-facebook" data-size="s"></span>
                    Facebook
                  </a>
                </li>
                <li>
                  <a href="https://twitter.com/quadrate-tech" target="_blank">
                    <span data-icon="ei-sc-twitter" data-size="s"></span>
                    Twitter
                  </a>
                </li>
              <li>
                  <a href="https://www.linkedin.com/company/quadrate-tech" target="_blank">
                    <span data-icon="ei-sc-linkedin" data-size="s"></span>
                    LinkedIn
                  </a>
                </li>
            </ul>
          </div>



        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="column large-12">
      <div class="site-footer__bottom">
        <div class="row">

          <div class="column medium-6 large-6">
            <div class="font-tiny">
               2020 quadrate-tech - Practical Coding Courses, Tutorials and Examples Series
            </div>
          </div>

          <div class="column medium-6 large-6 poweredby">
            <div class="font-tiny">
              Content on this site is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</a>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>

</footer>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-69010825-1', 'auto');
      ga('send', 'pageview');
</script>
  </div>

  <script src="../assets/js/prism.js?v=0a61b1323b"></script>
  <script src="../assets/js/jquery.min.js?v=0a61b1323b"></script>
  <script src="../assets/js/github-files.js?v=0a61b1323b"></script>
  <script src="../assets/js/autoads.js?v=0a61b1323b"></script>
  <script defer src="../assets/js/app.min.js?v=0a61b1323b"></script>
  <script defer src="../assets/js/scripts/script.js?v=0a61b1323b"></script> 
</body>
